{"mappings":"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","sources":["src/js/index-library.js","src/js/other/library-favorites-cards.js"],"sourcesContent":["// =============Fetches-JS =============\n\nimport \"./fetches/fetch-upcoming\";\nimport \"./fetches/fetch-movie-details\";\nimport \"./fetches/fetch-movie-genre\";\nimport \"./fetches/fetch-trailer\";\nimport \"./fetches/fetch-search\";\nimport \"./fetches/fetch-trendings\";\n\n// =============Modals-JS =============\n\nimport \"./modals/modal-team\"\nimport \"./modals/slider-modal-team\"\n\n// =============Other-JS =============\n\n// import \"./other/card-markup\"\nimport \"./other/switch-theme-btn\"\nimport \"./other/mob-menu\"\nimport \"./other/library-favorites-cards\"\nimport \"./other/slide-menu\"\nimport \"./other/current-page-track\"\nimport \"./other/scroll-up\"\n// import \"./other/test-card-markup\"\n","import { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport { cardMarkup } from './card-markup';\nimport { fetchTrailers } from '../fetches/fetch-trailer';\nimport { fetchMovieDetails } from '../fetches/fetch-movie-details';\n\nconst refs = {\n  heroContainer: document.querySelector('.home-hero > .container'),\n  trailerModal: document.querySelector('.trailer-modal-backdrop'),\n  trailerModalContent: document.querySelector('.trailer-modal-content'),\n  moreDetail: document.querySelector('.modal-film-info'),\n  closeModalBtn: document.querySelector('.modal-film-info .close-modal'),\n  closeTrailerBtn: document.querySelector('.close-trailer-btn'),\n  homeTrendsList: document.querySelector('.home-trends-list'),\n  body: document.querySelector('body'),\n  scrollUpBtn: document.querySelector('#back-to-top'),\n  wrap: document.querySelector('.flex'),\n};\n\nconst libraryCardList = document.querySelector('.card-list-search-result');\nconst sectionLibrary = document.querySelector('.library-film-list');\nconst librariesKey = 'films-id-array';\n// const moviesLocalId = JSON.parse(localStorage.getItem(librariesKey)) || [];\n\nlet arr = [];\nlet cardId;\nlet btnatlibrary;\nlet localArr = localStorage.getItem(librariesKey);\n\nrefs.closeModalBtn.addEventListener('click', closeMoreDetails);\nwindow.addEventListener('load', renderCards);\n\nfunction renderCards() {\n  if (localArr === null || JSON.parse(localArr).length === 0) {\n    const emptyLibrary = `<div class=\"container-library container\">\n      <p class=\"library-empty__mistake\">OOPS... <br> We are very sorry! <br> You don't have any movies at your library.</p>\n      <button class=\"main-accent-sml-btn btn library\" onclick=\"window.location.href='catalog.html'\">Search movie</button>\n    </div>`;\n    sectionLibrary.innerHTML = emptyLibrary;\n  } else {\n    const renderPromises = JSON.parse(localArr).map(id => renderFilmCard(id));\n\n    Promise.all(renderPromises)\n      .then(filmCards => {\n        const filmCardsHTML = filmCards.join('');\n        libraryCardList.innerHTML = filmCardsHTML;\n        onAddEventListener();\n      })\n      .catch(error => {\n        console.error('Error rendering film cards:', error);\n      });\n  }\n}\n\nasync function renderFilmCard(id) {\n  const movieMarkup = await cardMarkup(id);\n  return movieMarkup;\n}\n\nfunction onAddEventListener() {\n  let cardsArrRef = document.querySelectorAll('.film-card');\n  for (const card of cardsArrRef) {\n    card.addEventListener('click', onClick);\n  }\n}\n\nfunction onClick(e) {\n  e.preventDefault();\n  cardId = +e.currentTarget.id;\n  openModalDetails(cardId);\n  refs.body.style.overflow = 'hidden';\n  refs.scrollUpBtn.style.display = 'none';\n}\nfunction openModalDetails(cardId) {\n  refs.moreDetail.classList.remove('is-hidden');\n  markupMoreDetails(cardId);\n  document.addEventListener('keydown', onEscapeMoreDetails);\n}\n\nfunction closeMoreDetails() {\n  refs.moreDetail.classList.add('is-hidden');\n  document.removeEventListener('keydown', onEscapeMoreDetails);\n  refs.body.style.overflow = 'auto';\n}\n\nfunction onEscapeMoreDetails(e) {\n  if (e.key === 'Escape') {\n    closeMoreDetails();\n  }\n}\n\nasync function markupMoreDetails(currentId) {\n  try {\n    const movieDetails = await fetchMovieDetails(currentId);\n    const markup = `<div class=\"poster\"> \n          <img src=\"https://image.tmdb.org/t/p/original/${\n            movieDetails.smallPoster\n          }\" class=\"poster-img\" alt=\"the poster of the movie you have chosen\"/>\n        </div><div>\n          <h3 class=\"movie-title\">${\n            movieDetails.title\n          }</h3><div class=\"movie-info\">\n            <div class=\"info\">\n              <ul class=\"film-info-list\">\n                <li><p class=\"film-info-item-text\">Vote / Votes</p></li>\n                <li><p class=\"film-info-item-text\">Popularity</p></li>\n                <li><p class=\"film-info-item-text\">Genre</p></li>\n              </ul>\n            </div><div class=\"params\">\n              <ul class=\"film=info-params-list\">\n                <li><p class=\"film-info-params-vote\"><span class=\"film-info-params-vote-number\">${movieDetails.voteAverage.toFixed(\n                  1\n                )}</span> / <span class=\"film-info-params-vote-number\">${\n      movieDetails.voteCount\n    }</span></p>\n                </li>\n                <li><p class=\"popularity\">${movieDetails.popularity.toFixed(\n                  1\n                )}</p></li>\n                <li><p class=\"genre\">${movieDetails.genres}</p></li>  \n              </ul>  \n            </div>\n          </div><div class=\"about\">\n            <p>About</p>\n            <p>${movieDetails.overview}</p>\n          </div><div class=\"btn-list\">\n            <button class=\"main-accent-sml-btn btn modal\" id=\"btn-watch-treiller\" data-id=\"${currentId}\">Watch trailer</button>\n            <button class=\"add-to-my-library-btn btn modal\" id=\"btn-add-to-my-library\">Add to my library</button>\n          </div>\n        </div>`;\n    refs.wrap.innerHTML = markup;\n\n    const btnatreiller = document.querySelector('#btn-watch-treiller');\n    btnatlibrary = document.querySelector('#btn-add-to-my-library');\n\n    btnatreiller.addEventListener('click', OnWatchTrailerBtn);\n    btnatlibrary.addEventListener('click', action);\n\n    onCheckLocalStorage();\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nfunction OnWatchTrailerBtn(event) {\n  const cardId = +event.target.dataset.id;\n  openModal(cardId);\n}\n\nfunction openModal(cardId) {\n  refs.trailerModal.classList.remove('is-hidden');\n  watchTrailer(cardId);\n\n  document.addEventListener('keydown', onEscape);\n  refs.closeTrailerBtn.addEventListener('click', closeModal);\n}\n\nasync function watchTrailer(cardId) {\n  try {\n    const trailers = await fetchTrailers(cardId);\n\n    if (trailers.length > 0) {\n      const trailerKey = trailers[0].key;\n\n      const trailerContent = showTrailer(trailerKey);\n      refs.trailerModalContent.innerHTML = `<div class=\"trailer-modal-content\">${trailerContent}</div>`;\n    } else {\n      const errorContent = showError();\n      refs.trailerModal.innerHTML = `<div class=\"trailer-modal-content\">${errorContent}</div>`;\n    }\n  } catch (error) {\n    console.error('Error fetching trailer:', error);\n  }\n}\n\nfunction showTrailer(trailerKey) {\n  return `\n    <iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/${trailerKey}\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen></iframe>\n  `;\n}\n\nfunction showError() {\n  return `\n    <div class=\"trailer-error-info\">\n      <p>OOPS...</p>\n      <p>We are very sorry!</p>\n      <p>But we couldn't find the trailer.</p>\n    </div>\n    <picture>\n      <source srcset=\"../../images/trailer-placeholder/mobile/trailer-placeholder-1x.png, 1x, \n                    ../../images/trailer-placeholder/mobile/trailer-placeholder-2x.png, 2x\" \n              media=\"(max-width: 320px)\">\n      <source srcset=\"../../images/trailer-placeholder/tablet/trailer-placeholder-1x.png, 1x, \n                    ../../images/trailer-placeholder/tablet/trailer-placeholder-2x.png, 2x\" \n              media=\"(max-width: 768px)\">\n      <source srcset=\"../../images/trailer-placeholder/desktop/trailer-placeholder-1x.png, 1x, \n                    ../../images/trailer-placeholder/desktop/trailer-placeholder-2x.png, 2x\" \n              media=\"(min-width: 769px)\">\n      <img src=\"../../images/trailer-placeholder/mobile/trailer-placeholder-1x.png\" alt=\"Traier is not found\">\n    </picture>\n    </div>\n  `;\n}\n\nfunction onEscape(event) {\n  if (event.key === 'Escape') {\n    closeModal();\n  }\n}\n\nfunction closeModal() {\n  refs.trailerModal.classList.add('is-hidden');\n\n  refs.trailerModalContent.innerHTML = '';\n  document.removeEventListener('keydown', onEscape);\n  refs.closeModalBtn.removeEventListener('click', closeModal);\n}\n\nfunction onCheckLocalStorage() {\n  if (JSON.parse(localArr).includes(cardId)) {\n    toggleBtnStyles('Remove from my library');\n  }\n  if (localArr === null) {\n    toggleBtnStyles('Add to my library');\n  }\n}\n\nfunction action() {\n  closeMoreDetails();\n  localArr = localStorage.getItem('films-id-array');\n  try {\n    if (localArr === null) {\n      arr.push(cardId);\n      localStorage.setItem('films-id-array', JSON.stringify(arr));\n      localArr = localStorage.getItem('films-id-array');\n      toggleBtnStyles('Remove from my library');\n      renderCards();\n      return;\n    }\n    let parseLocalStorage = JSON.parse(localArr);\n\n    if (!parseLocalStorage.includes(cardId)) {\n      parseLocalStorage.push(cardId);\n      localStorage.setItem('films-id-array', JSON.stringify(parseLocalStorage));\n      localArr = localStorage.getItem('films-id-array');\n      toggleBtnStyles('Remove from my library');\n      renderCards();\n      return;\n    }\n    if (parseLocalStorage.includes(cardId)) {\n      const idx = parseLocalStorage.indexOf(cardId);\n      parseLocalStorage.splice(idx, 1);\n      localStorage.setItem('films-id-array', JSON.stringify(parseLocalStorage));\n      localArr = localStorage.getItem('films-id-array');\n      toggleBtnStyles('Add to my library');\n      renderCards();\n    }\n  } catch (error) {\n    Notify.failure('Please, try one more time');\n  }\n}\n\nfunction toggleBtnStyles(text) {\n  btnatlibrary.textContent = text;\n}\n"],"names":["parcelRequire","$575491aee910a457$var$cardId","$575491aee910a457$var$btnatlibrary","$bpxeT","$575491aee910a457$var$refs","heroContainer","document","querySelector","trailerModal","trailerModalContent","moreDetail","closeModalBtn","closeTrailerBtn","homeTrendsList","body","scrollUpBtn","wrap","$575491aee910a457$var$libraryCardList","$575491aee910a457$var$sectionLibrary","$575491aee910a457$var$arr","$575491aee910a457$var$localArr","localStorage","getItem","$575491aee910a457$var$renderCards","JSON","parse","length","innerHTML","renderPromises","map","id","$575491aee910a457$var$_renderFilmCard","apply","this","arguments","$575491aee910a457$var$renderFilmCard","Promise","all","then","filmCards","filmCardsHTML","join","cardsArrRef","querySelectorAll","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","value","addEventListener","$575491aee910a457$var$onClick","err","return","$575491aee910a457$var$onAddEventListener","catch","error","console","$parcel$interopDefault","$2TvXO","mark","_callee","movieMarkup","$5T9lI","cardMarkup","_ctx","sent","e","cardId1","preventDefault","currentTarget","classList","remove","currentId","$575491aee910a457$var$_markupMoreDetails","$575491aee910a457$var$markupMoreDetails","$575491aee910a457$var$onEscapeMoreDetails","style","overflow","display","$575491aee910a457$var$closeMoreDetails","add","removeEventListener","key","movieDetails","markup","btnatreiller","$ldyZu","fetchMovieDetails","concat","smallPoster","title","voteAverage","toFixed","voteCount","popularity","genres","overview","$575491aee910a457$var$OnWatchTrailerBtn","$575491aee910a457$var$action","$575491aee910a457$var$onCheckLocalStorage","log","t0","event","cardId3","cardId2","target","dataset","cardId4","$575491aee910a457$var$_watchTrailer","$575491aee910a457$var$watchTrailer","$575491aee910a457$var$onEscape","$575491aee910a457$var$closeModal","trailers","trailerKey","trailerContent","$dMHQ5","fetchTrailers","$575491aee910a457$var$showTrailer","includes","$575491aee910a457$var$toggleBtnStyles","push","setItem","stringify","parseLocalStorage","idx","indexOf","splice","$h6c0i","Notify","failure","text","textContent","window"],"version":3,"file":"library.387230b1.js.map"}